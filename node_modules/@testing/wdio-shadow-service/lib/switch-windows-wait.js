"use strict";
exports.__esModule = true;
exports.switchWindowWait = void 0;
var DEFAULT_ERROR_MESSAGE = "Can't switch window";
function switchWindowWait(regex, timeout, msgError, interval) {
    var result = browser.waitUntil(analyseWindows(regex), {
        interval: interval,
        timeoutMsg: msgError || DEFAULT_ERROR_MESSAGE,
        timeout: timeout
    });
    if (result) {
        browser.switchWindow(regex);
    }
    else {
        throw Error(DEFAULT_ERROR_MESSAGE);
    }
}
exports.switchWindowWait = switchWindowWait;
function analyseWindows(regex) {
    var actualHandle = browser.getWindowHandle();
    return function () {
        for (var _i = 0, _a = browser.getWindowHandles(); _i < _a.length; _i++) {
            var handle = _a[_i];
            if (handle !== actualHandle) {
                browser.switchToWindow(handle);
                if (browser.getTitle().match(regex) != null ||
                    browser.getUrl().match(regex) != null) {
                    return true;
                }
            }
        }
        return false;
    };
}
//# sourceMappingURL=switch-windows-wait.js.map