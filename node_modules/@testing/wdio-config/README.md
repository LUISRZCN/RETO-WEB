## Wdio Config

The present package handles all the configuration settings that can be used by Acis, providing with a lot of sensible defaults that make your life easier while at the same time it also enables the control of almost any available feature.

Acis' configuration settings are categorized in 4 groups:

- **[WebdriverIO Configuration Settings](docs/wdio.md)**
- **[Acis Options](docs/acis-options.md)**
- **[vBank Configuration Settings](https://globaldevtools.bbva.com/bitbucket/projects/BGT/repos/e2e-js-framework/browse/packages/wdio-vbank-service/docs/index.md)**
- **[Cucumber-framework Service Options](docs/cucumber-options.md)**

-----------------------

### configBuild

to get it exported so that it can be processed by the WwebdriverIO test-runner.

Example:

```js
    const { configBuild } = require('@testing/wdio-config');
    const recording = !!process.env.VBANK_RECORDING;
    
    const chrome = exports.chrome = {
        browserName: 'chrome',
        'goog:chromeOptions': {
            args: ['--window-size=1280,800', '--auto-open-devtools-for-tabs']
        },
        acceptInsecureCerts: true
    };
    
    const firefox = exports.firefox = {
        browserName: 'firefox',
        acceptInsecureCerts: true
    };
    
    exports.config = configBuild({
        // (1) WebdriverIO Configuration Settings
        baseUrl: 'http://localhost:5001',
        services: [[require('../stubs/server.service'), {}]],
        maxInstances: 3,
        sauceConnect: true,
        capabilities: [chrome, firefox]
        
        // (2) Acis Options
        acisOpts: {
          createOwnBrowser: true,
          testabilityOpts: {
            blacklist: [{
              url: /delay\/10/
            }],
            verbose: true,
            failOnTimeout: true
          }
        },

        // (3) vBank Configuration Settings
        vbank: {
            workspace: 'stubs/vbank',
            vbankHost: '(?!.*httpbin).*',
            backends: [
                {
                    name: 'httpbin',
                    realUrl: recording && 'https://httpbin.org/',
                    protocol: 'http',
                    port: '5000',
                    cors: {
                        headers: ['x-custom']
                    }
                },
                {
                    name: 'httpbin2',
                    realUrl: recording && 'https://httpbin.org/',
                    protocol: 'https',
                    port: '5005',
                    cors: {
                        headers: ['x-custom']
                    }
                }
            ],
            recording,
            parallel: true,
        },
        
        // (4) Cucumber-framework Service Options
        cucumberOpts: {
            retry: 2
        }
    });   
```

> #### (1) WebdriverIO Configuration Settings
> [Application to be executed in a local server](docs/wdio.md#baseurl) run by a [Wdio custom service](docs/wdio.md#services) located in *../stubs/server.service*.  
>
> It uses [Sauce Labs as browsers' provider and permission is granted to reach the local server](docs/wdio.md#sauceconnect) from Sauce Labs in order to run tests in [Chrome and Firefox](docs/wdio.md#capabilities).  
>
> [Three Wdio sessions](docs/wdio.md#maxinstances) are enabled to run at the same time.
> 
> #### (2) Acis Options
> Acis creates [an extra Wdio browser object with additional features](docs/acis-options.md#createownbrowser), that's used during the e2e testing process.  
>
> When executing the command *waitForApplicationToCompleteTasks*, [requests to urls with the path */delay/10/* are ignored](docs/acis-options.md#blacklist), [complete logs](docs/acis-options.md#verbose) are displayed and [test fails](docs/acis-options.md#failontimeout) when maximum time to finish a task is reached.
>
> #### (3) vBank Configuration Settings
> [Virtualized services' stubs are saved](https://globaldevtools.bbva.com/bitbucket/projects/BGT/repos/e2e-js-framework/browse/packages/wdio-vbank-service/docs/interfaces/VBankConfig.md) into the path *stubs/vbank*.  
>
> [vBank must intercept http(s) requests to the domain with pattern *(?!.\*httpbin).\**](https://globaldevtools.bbva.com/bitbucket/projects/BGT/repos/e2e-js-framework/browse/packages/wdio-vbank-service/docs/interfaces/VBankConfig.md), meaning that requests to that domain must be virtualized.  
>
> Requests to *http://httpbin:5000* and *https://httpbin2:5005* [are configured to be made from the testing environment](https://globaldevtools.bbva.com/bitbucket/projects/BGT/repos/e2e-js-framework/browse/packages/wdio-vbank-service/docs/interfaces/Backends.md) in order to vBank understand that a virtualized response must be checked when virtual mode is active or a virtualized response must be recorded from *https://httpbin.org/* when [recording mode](https://globaldevtools.bbva.com/bitbucket/projects/BGT/repos/e2e-js-framework/browse/packages/wdio-vbank-service/docs/interfaces/VBankConfig.md) is active.
>
> #### (4) Cucumber-framework Service Options
> It indicates to Cucumber runner [to try again a test that fails](docs/cucumber-options.md#retry).

---  

Did this documentation fullfilled your expectations? If you miss something, [let us know](mailto:testing.global.group@bbva.com)!